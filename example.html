<!DOCTYPE html>
<meta charset="utf-8">
<style>

.axis text {
  font: 10px sans-serif;
}

.axis path,
.axis line {
  fill: none;
  stroke: #000;
  shape-rendering: crispEdges;
}

.hexagon {
  fill: none;
}

</style>
<body>
<script src="http://d3js.org/d3.v3.min.js"></script>
<script src="/hexhex.js"></script>
<script>

var margin = { top: 20, right: 20, bottom: 30, left: 40 },
    width  = 960 - margin.left - margin.right,
    height = 2000 - margin.top - margin.bottom;

var constants = {
  height: 9,
  pad: 0,
  radius: 20,
  size: true
};

var color = d3.scale.linear()
    .domain([0, 20])
    .range(["white", "steelblue"])
    .interpolate(d3.interpolateLab);

var radius = d3.scale.pow()
    .exponent(0.8)
    .domain([0, 0.035])
    .range([0, constants.radius * 1.4]);

var hexhex = d3.hexhex()
    .size([width, height])
    .radius(constants.radius);

var x = d3.scale.pow()
    .exponent(1.1)
    .domain([0, width])
    .range([0, width * 0.9]);

var y = d3.scale.pow()
    .exponent(1)
    .domain([0, height])
    .range([0, height * 0.7]);

var svg = d3.select("body")
  .append("svg")
    .attr("width",  width  + margin.left + margin.right)
    .attr("height", height + margin.top  + margin.bottom)
  .append("g")
    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

var points = hexhex({ height: constants.height, pad: constants.pad }),
    cp = points[points.length / 2 | 0];

svg.append("g")
  .selectAll(".hexagon")
    .data(points)
  .enter().append("path")
    .attr("class", "hexagon")
    .attr("d", function (d) {
      return constants.size
        ? hexhex.hexagon(radius(d.size))
        : hexhex.hexagon();
    })
    .attr("transform", function(d) { return "translate(" + d.x + "," + d.y + ")"; })
    // .attr("transform", function(d) { return "translate(" + (x(d.x - cp.x) + 350) + "," + (y(d.y - cp.y) + 350) + ")"; })
    .style("fill", function(d) { return color(d.value); });
</script>